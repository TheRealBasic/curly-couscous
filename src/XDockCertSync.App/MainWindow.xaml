<Window x:Class="XDockCertSync.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="XDock Certificate Sync"
        Width="1200"
        Height="760"
        MinWidth="1024"
        MinHeight="700">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="170" />
            <ColumnDefinition Width="260" />
            <ColumnDefinition Width="20" />
            <ColumnDefinition Width="180" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <TextBlock Grid.Row="0" Grid.Column="0" Margin="0,0,12,12" VerticalAlignment="Center" Text="IP / Hostname" />
        <TextBox Grid.Row="0" Grid.Column="1" Margin="0,0,12,12" Text="{Binding Hostname, UpdateSourceTrigger=PropertyChanged}" />
        <Button Grid.Row="0" Grid.Column="3" HorizontalAlignment="Right" Padding="18,8" Content="Manual sync now" Command="{Binding ManualSyncNowCommand}" />

        <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,0,12,12" VerticalAlignment="Center" Text="Username" />
        <TextBox Grid.Row="1" Grid.Column="1" Margin="0,0,12,12" Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}" />

        <TextBlock Grid.Row="2" Grid.Column="0" Margin="0,0,12,12" VerticalAlignment="Center" Text="Password" />
        <PasswordBox Grid.Row="2" Grid.Column="1" Margin="0,0,12,12" PasswordChanged="PasswordBox_OnPasswordChanged" />

        <TextBlock Grid.Row="3" Grid.Column="0" Margin="0,0,12,12" VerticalAlignment="Center" Text="Polling Interval (sec)" />
        <TextBox Grid.Row="3" Grid.Column="1" Margin="0,0,12,12" Text="{Binding PollingIntervalSeconds, UpdateSourceTrigger=PropertyChanged}" />

        <TextBlock Grid.Row="4" Grid.Column="0" Margin="0,0,12,12" VerticalAlignment="Center" Text="Request timeout (sec)" />
        <TextBox Grid.Row="4" Grid.Column="1" Margin="0,0,12,12" Text="{Binding RequestTimeoutSeconds, UpdateSourceTrigger=PropertyChanged}" />

        <TextBlock Grid.Row="5" Grid.Column="0" Margin="0,0,12,12" VerticalAlignment="Center" Text="Retry attempts / backoff (ms)" />
        <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="0,0,12,12">
            <TextBox Width="65" Text="{Binding MaxRetryAttempts, UpdateSourceTrigger=PropertyChanged}" />
            <TextBlock Margin="8,0" VerticalAlignment="Center" Text="/" />
            <TextBox Width="95" Text="{Binding InitialBackoffMilliseconds, UpdateSourceTrigger=PropertyChanged}" />
        </StackPanel>

        <TextBlock Grid.Row="6" Grid.Column="0" Margin="0,0,12,12" VerticalAlignment="Center" Text="Output Directory" />
        <TextBox Grid.Row="6" Grid.Column="1" Margin="0,0,12,12" Text="{Binding OutputDirectory, UpdateSourceTrigger=PropertyChanged}" />
        <Button Grid.Row="6" Grid.Column="3" HorizontalAlignment="Right" Padding="18,8" Content="Save Settings" Command="{Binding SaveCommand}" />

        <StackPanel Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,0,0,10">
            <CheckBox Content="Enable automatic polling" IsChecked="{Binding AutoSyncEnabled}" VerticalAlignment="Center" Margin="0,0,20,0" />
            <TextBlock VerticalAlignment="Center" FontWeight="SemiBold" Text="Connectivity state:" />
            <TextBlock VerticalAlignment="Center" Margin="8,0,0,0" Text="{Binding ConnectivityState}" />
        </StackPanel>

        <GroupBox Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="5" Header="Query Filters" Margin="0,6,0,6" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="120" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="120" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="120" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="120" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="120" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Margin="0,0,8,0" VerticalAlignment="Center" Text="Detector serial" />
                <TextBox Grid.Column="1" Margin="0,0,10,0" Text="{Binding FilterDetectorSerial, UpdateSourceTrigger=PropertyChanged}" />
                <TextBlock Grid.Column="2" Margin="0,0,8,0" VerticalAlignment="Center" Text="From" />
                <TextBox Grid.Column="3" Margin="0,0,10,0" Text="{Binding FilterDateFrom, UpdateSourceTrigger=PropertyChanged}" />
                <TextBlock Grid.Column="4" Margin="0,0,8,0" VerticalAlignment="Center" Text="To" />
                <TextBox Grid.Column="5" Margin="0,0,10,0" Text="{Binding FilterDateTo, UpdateSourceTrigger=PropertyChanged}" />
                <TextBlock Grid.Column="6" Margin="0,0,8,0" VerticalAlignment="Center" Text="Pass/Fail" />
                <ComboBox Grid.Column="7" Margin="0,0,10,0" ItemsSource="{Binding PassFailOptions}" SelectedItem="{Binding FilterPassFail}" />
                <TextBlock Grid.Column="8" Margin="0,0,8,0" VerticalAlignment="Center" Text="Gas" />
                <TextBox Grid.Column="9" Margin="0,0,10,0" Text="{Binding FilterGasType, UpdateSourceTrigger=PropertyChanged}" />
                <Button Grid.Column="10" HorizontalAlignment="Right" Padding="12,6" Content="Apply filters" Command="{Binding ApplyFiltersCommand}" />
            </Grid>
        </GroupBox>

        <StackPanel Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="5" Orientation="Vertical">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,6">
                <Button Padding="12,6" Margin="0,0,8,0" Content="Export CSV" Command="{Binding ExportCsvCommand}" />
                <Button Padding="12,6" Content="Export PDF Summary" Command="{Binding ExportPdfSummaryCommand}" />
            </StackPanel>

            <DataGrid ItemsSource="{Binding Records}" IsReadOnly="True" AutoGenerateColumns="False" Height="280">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Detector" Binding="{Binding DeviceId}" Width="130" />
                    <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp}" Width="180" />
                    <DataGridTextColumn Header="Gas" Binding="{Binding GasType}" Width="120" />
                    <DataGridCheckBoxColumn Header="Passed" Binding="{Binding Passed}" Width="80" />
                    <DataGridTextColumn Header="Certificate Path" Binding="{Binding CertificateFilePath}" Width="*" />
                    <DataGridTextColumn Header="Hash" Binding="{Binding CertificateHash}" Width="230" />
                </DataGrid.Columns>
            </DataGrid>

            <TextBlock Margin="0,10,0,0" Foreground="DarkSlateGray" Text="{Binding StatusMessage}" TextWrapping="Wrap" />
        </StackPanel>
    </Grid>
</Window>
